{
    "sourceFile": "main.go",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1772220531048,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1772227736791,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,111 +2,104 @@\n \n import (\n \t\"net/http\"\n \n-\t\"github.com/km-arc/go-laravel/app\"\n-\tgohttp \"github.com/km-arc/go-laravel/http\"\n-\t\"github.com/km-arc/go-laravel/http/validation\"\n-\t\"github.com/km-arc/go-laravel/routing\"\n+\t\"github.com/km-arc/go-laravel/framework/app\"\n+\t\"github.com/km-arc/go-laravel/framework/container\"\n+\tgohttp \"github.com/km-arc/go-laravel/framework/http\"\n+\t\"github.com/km-arc/go-laravel/framework/http/validation\"\n+\t\"github.com/km-arc/go-laravel/framework/routing\"\n )\n \n+// ── Example: custom service provider ─────────────────────────────────────────\n+\n+// Logger is a simple example service.\n+type Logger struct{ prefix string }\n+\n+func (l *Logger) Info(msg string) { println(\"[\" + l.prefix + \"] \" + msg) }\n+\n+// LogServiceProvider mirrors Laravel's service provider pattern.\n+//\n+//\t// Laravel:\n+//\t// class LogServiceProvider extends ServiceProvider {\n+//\t//     public function register(): void {\n+//\t//         $this->app->singleton(Logger::class, fn() => new Logger);\n+//\t//     }\n+//\t// }\n+type LogServiceProvider struct{ container.BaseProvider }\n+\n+func (p *LogServiceProvider) Register(app *container.Container) {\n+\tapp.Singleton(\"logger\", func(c *container.Container) any {\n+\t\treturn &Logger{prefix: \"APP\"}\n+\t})\n+}\n+\n+func (p *LogServiceProvider) Boot(app *container.Container) {\n+\tlogger := container.Resolve[*Logger](app, \"logger\")\n+\tlogger.Info(\"Application booted ✅\")\n+}\n+\n+// ── main ──────────────────────────────────────────────────────────────────────\n+\n func main() {\n-\tapplication := app.New() // loads .env automatically\n+\t// 1. Create application (loads .env, registers core providers)\n+\t//    Laravel: $app = require __DIR__.'/../bootstrap/app.php';\n+\tapplication := app.New()\n \n-\tr := application.Router\n+\t// 2. Register your own providers\n+\t//    Laravel: $app->register(new LogServiceProvider($app))\n+\tapplication.Register(&LogServiceProvider{})\n \n-\t// ── Basic routes ─────────────────────────────────────────────────────────\n+\t// 3. Register routes (resolve router from container)\n+\t//    Laravel: Route::get('/', ...)\n+\tr := application.Router()\n \n \tr.Get(\"/\", func(w http.ResponseWriter, req *http.Request) {\n-\t\tres := gohttp.NewResponse(w)\n-\t\tres.Success(map[string]any{\"message\": \"Welcome to Go-Laravel!\"})\n+\t\tgohttp.NewResponse(w).Success(map[string]any{\n+\t\t\t\"app\":     application.Config().App.Name,\n+\t\t\t\"version\": application.Version(),\n+\t\t\t\"env\":     application.Environment(),\n+\t\t})\n \t})\n \n-\t// ── Route prefix (like Route::prefix('api')) ──────────────────────────────\n-\n+\t// 4. API prefix group\n \tr.Prefix(\"/api/v1\", func(api *routing.Router) {\n \n-\t\t// GET /api/v1/users\n-\t\tapi.Get(\"/users\", func(w http.ResponseWriter, req *http.Request) {\n-\t\t\tres := gohttp.NewResponse(w)\n-\t\t\tres.Success([]map[string]any{\n-\t\t\t\t{\"id\": 1, \"name\": \"Alice\"},\n-\t\t\t\t{\"id\": 2, \"name\": \"Bob\"},\n-\t\t\t})\n-\t\t})\n-\n-\t\t// POST /api/v1/users\n \t\tapi.Post(\"/users\", func(w http.ResponseWriter, req *http.Request) {\n \t\t\trequest := gohttp.NewRequest(req)\n \t\t\tres := gohttp.NewResponse(w)\n \n-\t\t\t// 1. Bind JSON body into a struct\n \t\t\tvar body struct {\n \t\t\t\tName  string `json:\"name\"`\n \t\t\t\tEmail string `json:\"email\"`\n-\t\t\t\tAge   string `json:\"age\"`\n \t\t\t}\n \t\t\tif err := request.Bind(&body); err != nil {\n \t\t\t\tres.Error(http.StatusBadRequest, err.Error())\n \t\t\t\treturn\n \t\t\t}\n \n-\t\t\t// 2. Validate — Laravel-style rules\n \t\t\tv := validation.Make(map[string]string{\n \t\t\t\t\"name\":  body.Name,\n \t\t\t\t\"email\": body.Email,\n-\t\t\t\t\"age\":   body.Age,\n \t\t\t}, validation.Rules{\n \t\t\t\t\"name\":  \"required|min:2|max:100\",\n \t\t\t\t\"email\": \"required|email\",\n-\t\t\t\t\"age\":   \"required|numeric|gte:18\",\n \t\t\t})\n \n \t\t\tif v.Fails() {\n-\t\t\t\t// 3. Return 422 {\"errors\": {\"field\": [\"msg\"]}}\n \t\t\t\tres.ValidationError(v.Errors())\n \t\t\t\treturn\n \t\t\t}\n \n-\t\t\t// 4. Return 201 created\n-\t\t\tres.Created(map[string]any{\n-\t\t\t\t\"name\":  body.Name,\n-\t\t\t\t\"email\": body.Email,\n-\t\t\t})\n-\t\t})\n+\t\t\t// Resolve logger from container anywhere in your app\n+\t\t\tlogger := container.Resolve[*Logger](application.Container, \"logger\")\n+\t\t\tlogger.Info(\"Creating user: \" + body.Name)\n \n-\t\t// GET /api/v1/users/{id}\n-\t\tapi.Get(\"/users/{id}\", func(w http.ResponseWriter, req *http.Request) {\n-\t\t\tres := gohttp.NewResponse(w)\n-\t\t\tid := routing.Param(req, \"id\")\n-\t\t\tres.Success(map[string]any{\"id\": id})\n+\t\t\tres.Created(map[string]any{\"name\": body.Name, \"email\": body.Email})\n \t\t})\n \n \t})\n \n-\t// ── Auth group with middleware ─────────────────────────────────────────────\n-\n-\tr.Group(func(protected *routing.Router) {\n-\t\tprotected.Middleware(AuthMiddleware)\n-\n-\t\tprotected.Get(\"/profile\", func(w http.ResponseWriter, req *http.Request) {\n-\t\t\tres := gohttp.NewResponse(w)\n-\t\t\tres.Success(map[string]any{\"user\": \"authenticated\"})\n-\t\t})\n-\t})\n-\n+\t// 5. Boot + run\n+\t//    Laravel: $kernel->handle(Request::capture())\n \tapplication.Run()\n-}\n-\n-// AuthMiddleware is an example JWT/token guard.\n-func AuthMiddleware(next http.Handler) http.Handler {\n-\treturn http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n-\t\treq := gohttp.NewRequest(r)\n-\t\tres := gohttp.NewResponse(w)\n-\n-\t\tif req.BearerToken() == \"\" {\n-\t\t\tres.Unauthorized()\n-\t\t\treturn\n-\t\t}\n-\t\tnext.ServeHTTP(w, r)\n-\t})\n-}\n+}\n\\ No newline at end of file\n"
                }
            ],
            "date": 1772220531047,
            "name": "Commit-0",
            "content": "package main\n\nimport (\n\t\"net/http\"\n\n\t\"github.com/km-arc/go-laravel/app\"\n\tgohttp \"github.com/km-arc/go-laravel/http\"\n\t\"github.com/km-arc/go-laravel/http/validation\"\n\t\"github.com/km-arc/go-laravel/routing\"\n)\n\nfunc main() {\n\tapplication := app.New() // loads .env automatically\n\n\tr := application.Router\n\n\t// ── Basic routes ─────────────────────────────────────────────────────────\n\n\tr.Get(\"/\", func(w http.ResponseWriter, req *http.Request) {\n\t\tres := gohttp.NewResponse(w)\n\t\tres.Success(map[string]any{\"message\": \"Welcome to Go-Laravel!\"})\n\t})\n\n\t// ── Route prefix (like Route::prefix('api')) ──────────────────────────────\n\n\tr.Prefix(\"/api/v1\", func(api *routing.Router) {\n\n\t\t// GET /api/v1/users\n\t\tapi.Get(\"/users\", func(w http.ResponseWriter, req *http.Request) {\n\t\t\tres := gohttp.NewResponse(w)\n\t\t\tres.Success([]map[string]any{\n\t\t\t\t{\"id\": 1, \"name\": \"Alice\"},\n\t\t\t\t{\"id\": 2, \"name\": \"Bob\"},\n\t\t\t})\n\t\t})\n\n\t\t// POST /api/v1/users\n\t\tapi.Post(\"/users\", func(w http.ResponseWriter, req *http.Request) {\n\t\t\trequest := gohttp.NewRequest(req)\n\t\t\tres := gohttp.NewResponse(w)\n\n\t\t\t// 1. Bind JSON body into a struct\n\t\t\tvar body struct {\n\t\t\t\tName  string `json:\"name\"`\n\t\t\t\tEmail string `json:\"email\"`\n\t\t\t\tAge   string `json:\"age\"`\n\t\t\t}\n\t\t\tif err := request.Bind(&body); err != nil {\n\t\t\t\tres.Error(http.StatusBadRequest, err.Error())\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// 2. Validate — Laravel-style rules\n\t\t\tv := validation.Make(map[string]string{\n\t\t\t\t\"name\":  body.Name,\n\t\t\t\t\"email\": body.Email,\n\t\t\t\t\"age\":   body.Age,\n\t\t\t}, validation.Rules{\n\t\t\t\t\"name\":  \"required|min:2|max:100\",\n\t\t\t\t\"email\": \"required|email\",\n\t\t\t\t\"age\":   \"required|numeric|gte:18\",\n\t\t\t})\n\n\t\t\tif v.Fails() {\n\t\t\t\t// 3. Return 422 {\"errors\": {\"field\": [\"msg\"]}}\n\t\t\t\tres.ValidationError(v.Errors())\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// 4. Return 201 created\n\t\t\tres.Created(map[string]any{\n\t\t\t\t\"name\":  body.Name,\n\t\t\t\t\"email\": body.Email,\n\t\t\t})\n\t\t})\n\n\t\t// GET /api/v1/users/{id}\n\t\tapi.Get(\"/users/{id}\", func(w http.ResponseWriter, req *http.Request) {\n\t\t\tres := gohttp.NewResponse(w)\n\t\t\tid := routing.Param(req, \"id\")\n\t\t\tres.Success(map[string]any{\"id\": id})\n\t\t})\n\n\t})\n\n\t// ── Auth group with middleware ─────────────────────────────────────────────\n\n\tr.Group(func(protected *routing.Router) {\n\t\tprotected.Middleware(AuthMiddleware)\n\n\t\tprotected.Get(\"/profile\", func(w http.ResponseWriter, req *http.Request) {\n\t\t\tres := gohttp.NewResponse(w)\n\t\t\tres.Success(map[string]any{\"user\": \"authenticated\"})\n\t\t})\n\t})\n\n\tapplication.Run()\n}\n\n// AuthMiddleware is an example JWT/token guard.\nfunc AuthMiddleware(next http.Handler) http.Handler {\n\treturn http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n\t\treq := gohttp.NewRequest(r)\n\t\tres := gohttp.NewResponse(w)\n\n\t\tif req.BearerToken() == \"\" {\n\t\t\tres.Unauthorized()\n\t\t\treturn\n\t\t}\n\t\tnext.ServeHTTP(w, r)\n\t})\n}\n"
        }
    ]
}